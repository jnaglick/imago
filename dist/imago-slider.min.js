var imagoSlider,imagoSliderController;imagoSlider=function(){function e(e,n,r,i){return{transclude:!0,scope:!0,templateUrl:"/imago/imago-slider.html",controller:"imagoSliderController as imagoslider",bindToController:{assets:"=?imagoSlider"},link:function(t,o,l,a,s){var c,g,d,u,m;m=[],t.imagoslider.length=l.length||(null!=(d=t.imagoslider.assets)?d.length:void 0),s(t,function(e){return o.children().append(e)});for(c in l)u=l[c],"$"!==c.charAt(0)&&(("true"===u||"false"===u)&&(u=JSON.parse(u)),t.imagoslider.conf[c]=u);return angular.isDefined(l.length)?l.$observe("length",function(e){return t.imagoslider.length=e}):t.$watchCollection("imagoslider.assets",function(e){return e&&_.isArray(e)?(t.imagoslider.length=e.length,t.prefetch("initial")):void 0}),t.imagoslider.conf.siblings=!(!t.imagoslider.conf.next||!t.imagoslider.conf.prev),t.currentIndex=i.path().indexOf("last")?parseInt(t.imagoslider.conf.current):t.getLast(),t.clearInterval=function(){return t.imagoslider.conf.interval?r.cancel(t.imagoslider.conf.interval):void 0},t.imagoslider.goPrev=function(e){return"object"==typeof e&&(t.clearInterval(),e.stopPropagation()),t.imagoslider.conf.loop?t.imagoslider.conf.loop&&!t.imagoslider.conf.siblings?t.imagoslider.setCurrent(t.currentIndex>0?t.currentIndex-1:parseInt(t.imagoslider.length)-1):t.imagoslider.conf.loop&&t.imagoslider.conf.siblings&&(t.currentIndex>0?t.imagoslider.setCurrent(t.currentIndex-1):i.path(t.imagoslider.conf.prev)):t.imagoslider.setCurrent(t.currentIndex>0?t.currentIndex-1:t.currentIndex),t.prefetch("prev")},t.imagoslider.goNext=function(e){return function(e,n){return null==n&&(n=!0),("object"==typeof e||n)&&(t.clearInterval(),e&&e.stopPropagation()),t.imagoslider.conf.loop?t.imagoslider.conf.loop&&!t.imagoslider.conf.siblings?t.imagoslider.setCurrent(t.currentIndex<t.imagoslider.length-1?t.currentIndex+1:0):t.imagoslider.conf.loop&&t.imagoslider.conf.siblings&&(t.currentIndex<t.imagoslider.length-1?t.imagoslider.setCurrent(t.currentIndex+1):i.path(t.imagoslider.conf.next)):t.imagoslider.setCurrent(t.currentIndex<t.imagoslider.length-1?t.currentIndex+1:t.currentIndex),t.prefetch("next")}}(this),t.prefetch=function(e){var n,r,i,o;if(t.imagoslider.conf.prefetch&&(null!=(i=t.imagoslider.assets)?i.length:void 0)&&(t.currentIndex===t.getLast()?n=0:"initial"===e?n=1:"prev"===e?n=angular.copy(t.currentIndex)-1:"next"===e&&(n=angular.copy(t.currentIndex)+1),(null!=(o=t.imagoslider.assets[n])?o.serving_url:void 0)&&t.imagoslider.servingSize))return r=new Image,r.src=t.imagoslider.assets[n].serving_url+t.imagoslider.servingSize},t.getLast=function(){return Number(t.imagoslider.length)-1},t.getCurrent=function(){return t.currentIndex},t.imagoslider.setCurrent=function(n){return t.action=function(){switch(!1){case!(0===n&&t.currentIndex===parseInt(this.length)-1&&!this.conf.siblings):return"next";case!(n===parseInt(this.length)-1&&0===t.currentIndex&&!this.conf.siblings):return"prev";case!(n>t.currentIndex):return"next";case!(n<t.currentIndex):return"prev";default:return""}}.call(this),void 0===n?this.goNext():(t.currentIndex=n,e.$emit(this.conf.namespace+":changed",n))},_.isUndefined(l.autoplay)||t.$watch(l.autoplay,function(e){return function(e){return parseInt(e)>0?t.imagoslider.conf.interval=r(function(){return t.imagoslider.goNext("",!1)},parseInt(e)):t.clearInterval()}}(this)),g=function(e){switch(e.keyCode){case 37:return t.$apply(function(){return t.imagoslider.goPrev()});case 39:return t.$apply(function(){return t.imagoslider.goNext()})}},t.imagoslider.conf.enablekeys&&n.on("keydown",g),m.push(e.$on(t.imagoslider.conf.namespace+":change",function(e,n){return t.clearInterval(),t.imagoslider.setCurrent(n)})),t.$on("$destroy",function(){var e,r,i,o;for(n.off("keydown",g),t.clearInterval(),i=[],e=0,r=m.length;r>e;e++)o=m[e],i.push(o());return i})}}}return e}(),imagoSliderController=function(){function e(){this.conf={animation:"fade",enablekeys:!0,enablearrows:!0,loop:!0,current:0,namespace:"slider",autoplay:0,next:null,prev:null,prefetch:!0},this.setServingSize=function(e){return function(n){return e.servingSize=n}}(this)}return e}(),angular.module("imago").directive("imagoSlider",["$rootScope","$document","$interval","$location",imagoSlider]).controller("imagoSliderController",[imagoSliderController]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imago-slider.html",'<div ng-class="[imagoslider.conf.animation, action]" ng-swipe-left="imagoslider.goNext($event)" ng-swipe-right="imagoslider.goPrev($event)" class="imagoslider"><div ng-show="imagoslider.conf.enablearrows &amp;&amp; imagoslider.length &gt; 1" ng-click="imagoslider.goPrev($event)" analytics-on="click" analytics-event="Previous Slide" class="prev"></div><div ng-show="imagoslider.conf.enablearrows &amp;&amp; imagoslider.length &gt; 1" ng-click="imagoslider.goNext($event)" analytics-on="click" analytics-event="Next Slide" class="next"></div></div>')}]);